<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Case studies (GEB_739_sm_AppendixS2-S5) • rangeMapper</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/cosmo/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet">
<meta property="og:title" content="Case studies (GEB_739_sm_AppendixS2-S5)">
<meta property="og:description" content="rangeMapper">
<meta property="og:image" content="https://mpio-be.github.io/rangeMapper/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-189010623-1"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-189010623-1');
</script>
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">rangeMapper</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">2.0.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../articles/rangeMapper.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/Case_studies_Valcu_et_al_2012.html">Case studies (GEB_739_sm_AppendixS2-S5)</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/mpio-be/rangeMapper/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="Case_studies_Valcu_et_al_2012_files/header-attrs-2.6/header-attrs.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Case studies (GEB_739_sm_AppendixS2-S5)</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/mpio-be/rangeMapper/blob/master/vignettes/Case_studies_Valcu_et_al_2012.Rmd"><code>vignettes/Case_studies_Valcu_et_al_2012.Rmd</code></a></small>
      <div class="hidden name"><code>Case_studies_Valcu_et_al_2012.Rmd</code></div>

    </div>

    
    
<p>Supporting information in <a href="https://onlinelibrary.wiley.com/doi/10.1111/j.1466-8238.2011.00739.x" target="_blank"> Valcu, M., Dale, J., and Kempenaers, B. (2012). rangeMapper: a platform for the study of macroecology of life-history traits. Global Ecology and Biogeography 21, 945-951. </a></p>
<div id="general-project-setup" class="section level3">
<h3 class="hasAnchor">
<a href="#general-project-setup" class="anchor"></a>General project setup</h3>
<p>We setup a project using a hexagonal canvas with a cell size of 500 km. The project is set <code>in-memory</code> but for a real case study you would like to set <code>path</code> to a persistent location on disk.<br>
We’ll use the <code>wrens</code> dataset which is part of the package.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">require</a></span><span class="op">(</span><span class="va"><a href="https://github.com/mpio-be/rangeMapper">rangeMapper</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">require</a></span><span class="op">(</span><span class="va"><a href="https://r-spatial.github.io/sf/">sf</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">require</a></span><span class="op">(</span><span class="va"><a href="https://Rdatatable.gitlab.io/data.table">data.table</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">require</a></span><span class="op">(</span><span class="va"><a href="https://github.com/tidyverse/glue">glue</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">require</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org">ggplot2</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">require</a></span><span class="op">(</span><span class="va"><a href="https://github.com/sjmgarnier/viridis">viridis</a></span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="va">wrens</span><span class="op">)</span>
<span class="va">wrens</span><span class="op">$</span><span class="va">breeding_range_area</span> <span class="op">=</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/geos_measures.html">st_area</a></span><span class="op">(</span><span class="va">wrens</span><span class="op">)</span>

<span class="va">con</span> <span class="op">=</span> <span class="fu"><a href="../reference/rmap_connect.html">rmap_connect</a></span><span class="op">(</span><span class="op">)</span>

<span class="fu"><a href="../reference/rmap_add_ranges.html">rmap_add_ranges</a></span><span class="op">(</span><span class="va">con</span>, x <span class="op">=</span> <span class="va">wrens</span>, ID <span class="op">=</span> <span class="st">'sci_name'</span><span class="op">)</span>
<span class="fu"><a href="../reference/rmap_prepare.html">rmap_prepare</a></span><span class="op">(</span><span class="va">con</span>, <span class="st">'hex'</span>, cellsize <span class="op">=</span> <span class="fl">500</span><span class="op">)</span>
<span class="fu"><a href="../reference/rmap_add_bio.html">rmap_add_bio</a></span><span class="op">(</span><span class="va">con</span>, <span class="va">wrens</span>, <span class="st">'sci_name'</span><span class="op">)</span></code></pre></div>
</div>
<div id="raw-data-wrens-breeding-range-distribution-and-life-history" class="section level3">
<h3 class="hasAnchor">
<a href="#raw-data-wrens-breeding-range-distribution-and-life-history" class="anchor"></a>Raw data: wrens breeding range distribution and life history</h3>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html">geom_sf</a></span><span class="op">(</span>data <span class="op">=</span> <span class="fu"><a href="../reference/rmap_to_sf.html">rmap_to_sf</a></span><span class="op">(</span><span class="va">con</span>, <span class="st">'wkt_canvas'</span><span class="op">)</span> , color <span class="op">=</span> <span class="st">'grey80'</span>, fill <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html">geom_sf</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">wrens</span>, fill <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span> </code></pre></div>
<p><img src="Case_studies_Valcu_et_al_2012_files/figure-html/unnamed-chunk-2-1.png" width="700"></p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">wrens</span>,<span class="fl">3</span><span class="op">)</span>
<span class="co">#&gt; Simple feature collection with 3 features and 12 fields</span>
<span class="co">#&gt; geometry type:  MULTIPOLYGON</span>
<span class="co">#&gt; dimension:      XY</span>
<span class="co">#&gt; bbox:           xmin: -9816.989 ymin: 2146.502 xmax: -7998.838 ymax: 3641.424</span>
<span class="co">#&gt; CRS:            +proj=eck4 +lon_0=0 +x_0=0 +y_0=0 +datum=WGS84 +units=km +no_defs</span>
<span class="co">#&gt;   ID                    sci_name       com_name subspecies clutch_size</span>
<span class="co">#&gt; 1  1     Campylorhynchus_jocosus boucard's wren          1         3.5</span>
<span class="co">#&gt; 2  2     Campylorhynchus_gularis   spotted wren          1         4.0</span>
<span class="co">#&gt; 3  3 Campylorhynchus_yucatanicus   yucatan wren          1         3.0</span>
<span class="co">#&gt;   male_wing female_wing male_tarsus female_tarsus body_mass      data_src</span>
<span class="co">#&gt; 1     73.10       70.30        22.9          22.2      27.6 1,1,1,1,1,1,3</span>
<span class="co">#&gt; 2     74.00       71.75        24.0          24.0      30.1 1,2,1,1,1,1,3</span>
<span class="co">#&gt; 3     76.55       71.35        25.1          23.6      35.5 1,2,1,1,1,1,3</span>
<span class="co">#&gt;                         geometry breeding_range_area</span>
<span class="co">#&gt; 1 MULTIPOLYGON (((-9106.223 2...     68419.50 [km^2]</span>
<span class="co">#&gt; 2 MULTIPOLYGON (((-9056.978 3...    237563.90 [km^2]</span>
<span class="co">#&gt; 3 MULTIPOLYGON (((-7998.838 2...     11366.63 [km^2]</span></code></pre></div>
</div>
<div id="case-study-1-different-biodiversity-hotspots-and-their-congruence-" class="section level2">
<h2 class="hasAnchor">
<a href="#case-study-1-different-biodiversity-hotspots-and-their-congruence-" class="anchor"></a>Case study 1: Different biodiversity hotspots and their congruence.</h2>
<p>We describe biodiversity hotspots based on of three avian diversity parameters: <strong>total species richness</strong>, <strong>endemic species richness</strong> and <strong>relative body mass diversity</strong>.</p>
<div id="set-parameters" class="section level3">
<h3 class="hasAnchor">
<a href="#set-parameters" class="anchor"></a>1. Set parameters</h3>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">P_richness</span>  <span class="op">=</span> <span class="fl">0.75</span> <span class="co"># species richness quantile</span>
<span class="va">P_bodymass</span>  <span class="op">=</span> <span class="fl">0.50</span> <span class="co"># CV body mass quantile</span>
<span class="va">P_endemics</span>  <span class="op">=</span> <span class="fl">0.35</span> <span class="co"># endemic species richness quantile</span></code></pre></div>
</div>
<div id="primary-maps-and-thresholds" class="section level3">
<h3 class="hasAnchor">
<a href="#primary-maps-and-thresholds" class="anchor"></a>2. Primary maps and thresholds</h3>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/rmap_save_map.html">rmap_save_map</a></span><span class="op">(</span><span class="va">con</span><span class="op">)</span>  
<span class="co"># rmap_save_map with no arguments other than `con` saves a species_richness map.</span>

<span class="va">CV_Mass</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>,na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>,na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="../reference/rmap_save_map.html">rmap_save_map</a></span><span class="op">(</span><span class="va">con</span>, fun <span class="op">=</span> <span class="va">CV_Mass</span>, src<span class="op">=</span><span class="st">'wrens'</span>,v <span class="op">=</span> <span class="st">'body_mass'</span>, dst<span class="op">=</span><span class="st">'CV_Mass'</span><span class="op">)</span></code></pre></div>
<p>Thresholds are computed using the parameters defined in <strong>1</strong> and the maps saved at <strong>2</strong>.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">sr</span> <span class="op">=</span> <span class="fu"><a href="../reference/rmap_to_sf.html">rmap_to_sf</a></span><span class="op">(</span><span class="va">con</span>, <span class="st">"species_richness"</span><span class="op">)</span>
<span class="va">sr_threshold</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html">quantile</a></span><span class="op">(</span><span class="va">sr</span><span class="op">$</span><span class="va">species_richness</span>, probs <span class="op">=</span> <span class="va">P_richness</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>

<span class="va">es_threshold</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html">quantile</a></span><span class="op">(</span><span class="va">wrens</span><span class="op">$</span><span class="va">breeding_range_area</span>, probs <span class="op">=</span> <span class="va">P_endemics</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>

<span class="va">bmr</span> <span class="op">=</span> <span class="fu"><a href="../reference/rmap_to_sf.html">rmap_to_sf</a></span><span class="op">(</span><span class="va">con</span>, <span class="st">"CV_Mass"</span><span class="op">)</span>
<span class="va">bmr_threshold</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html">quantile</a></span><span class="op">(</span><span class="va">bmr</span><span class="op">$</span><span class="va">V1_body_mass</span>, probs <span class="op">=</span> <span class="va">P_bodymass</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
</div>
<div id="congruence-subsets-and-congruence-maps" class="section level3">
<h3 class="hasAnchor">
<a href="#congruence-subsets-and-congruence-maps" class="anchor"></a>3. Congruence subsets and congruence maps</h3>
<div id="subsets" class="section level4">
<h4 class="hasAnchor">
<a href="#subsets" class="anchor"></a>3.1 Subsets</h4>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/rmap_save_subset.html">rmap_save_subset</a></span><span class="op">(</span><span class="va">con</span>,<span class="st">'sr_threshold'</span>, species_richness <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">'species_richness     &gt;'</span>, <span class="va">sr_threshold</span><span class="op">)</span> <span class="op">)</span>
<span class="fu"><a href="../reference/rmap_save_subset.html">rmap_save_subset</a></span><span class="op">(</span><span class="va">con</span>,<span class="st">'es_threshold'</span>, wrens            <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">'breeding_range_area &lt;='</span>, <span class="va">es_threshold</span><span class="op">)</span> <span class="op">)</span>
<span class="fu"><a href="../reference/rmap_save_subset.html">rmap_save_subset</a></span><span class="op">(</span><span class="va">con</span>,<span class="st">'bmr_threshold'</span>, CV_Mass         <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">'V1_body_mass        &gt;='</span>, <span class="va">bmr_threshold</span><span class="op">)</span><span class="op">)</span>

<span class="fu"><a href="../reference/rmap_save_subset.html">rmap_save_subset</a></span><span class="op">(</span><span class="va">con</span>, <span class="st">"cumul_congruence_threshold"</span>,
    species_richness <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">'species_richness &gt;'</span>, <span class="va">sr_threshold</span><span class="op">)</span>,
    wrens            <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">'breeding_range_area &lt;='</span>, <span class="va">es_threshold</span><span class="op">)</span>, 
    CV_Mass          <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">'body_mass &gt;='</span>, <span class="va">bmr_threshold</span><span class="op">)</span> 
    <span class="op">)</span></code></pre></div>
</div>
<div id="threshold-maps" class="section level4">
<h4 class="hasAnchor">
<a href="#threshold-maps" class="anchor"></a>3.2 Threshold Maps</h4>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/rmap_save_map.html">rmap_save_map</a></span><span class="op">(</span><span class="va">con</span>, subset <span class="op">=</span> <span class="st">'sr_threshold'</span>, dst <span class="op">=</span> <span class="st">'Species_richness_hotspots'</span><span class="op">)</span>
<span class="fu"><a href="../reference/rmap_save_map.html">rmap_save_map</a></span><span class="op">(</span><span class="va">con</span>, subset <span class="op">=</span> <span class="st">'es_threshold'</span>, dst <span class="op">=</span> <span class="st">'Endemics_hotspots'</span><span class="op">)</span>
<span class="fu"><a href="../reference/rmap_save_map.html">rmap_save_map</a></span><span class="op">(</span><span class="va">con</span>, subset <span class="op">=</span> <span class="st">'bmr_threshold'</span>, dst <span class="op">=</span> <span class="st">'Body_mass_diversity_hotspots'</span><span class="op">)</span>
<span class="fu"><a href="../reference/rmap_save_map.html">rmap_save_map</a></span><span class="op">(</span><span class="va">con</span>, subset <span class="op">=</span> <span class="st">'cumul_congruence_threshold'</span>, dst <span class="op">=</span> <span class="st">'Cumul_congruence_hotspots'</span><span class="op">)</span></code></pre></div>
</div>
</div>
<div id="maps-load-and-display" class="section level3">
<h3 class="hasAnchor">
<a href="#maps-load-and-display" class="anchor"></a>4. Maps: load and display</h3>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">study_area</span> <span class="op">=</span> <span class="fu"><a href="../reference/rmap_to_sf.html">rmap_to_sf</a></span><span class="op">(</span><span class="va">con</span>, <span class="st">'species_richness'</span><span class="op">)</span>  <span class="op">%&gt;%</span> <span class="va">st_union</span>
<span class="va">bmr</span> <span class="op">=</span> <span class="fu"><a href="../reference/rmap_to_sf.html">rmap_to_sf</a></span><span class="op">(</span><span class="va">con</span>, pattern <span class="op">=</span> <span class="st">'hotspots'</span><span class="op">)</span>  <span class="op">%&gt;%</span> 
      <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/melt.data.table.html">melt</a></span><span class="op">(</span>id.vars <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'geometry'</span>, <span class="st">'cell_id'</span><span class="op">)</span> <span class="op">)</span>  <span class="op">%&gt;%</span> 
      <span class="va">st_as_sf</span>
<span class="va">bmr</span><span class="op">$</span><span class="va">variable</span> <span class="op">=</span> <span class="va">bmr</span><span class="op">$</span><span class="va">variable</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html">gsub</a></span><span class="op">(</span><span class="st">'species_richness_|_hotspots'</span>, <span class="st">''</span>, <span class="va">.</span><span class="op">)</span>      

<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">variable</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html">geom_sf</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">study_area</span> <span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html">geom_sf</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">bmr</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="va">value</span><span class="op">)</span>,  size<span class="op">=</span> <span class="fl">0.05</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_gradient.html">scale_fill_gradientn</a></span><span class="op">(</span>colours <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/viridisLite/man/viridis.html">viridis</a></span><span class="op">(</span><span class="fl">10</span>, option <span class="op">=</span> <span class="st">'E'</span><span class="op">)</span>, na.value<span class="op">=</span> <span class="st">'grey80'</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guides.html">guides</a></span><span class="op">(</span>fill<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guide_legend.html">guide_legend</a></span><span class="op">(</span>title<span class="op">=</span><span class="st">'Wren\nspecies'</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ggtitle</a></span><span class="op">(</span><span class="st">"Hotspots"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<p><img src="Case_studies_Valcu_et_al_2012_files/figure-html/unnamed-chunk-8-1.png" width="700"></p>
</div>
</div>
<div id="case-study-2-geographical-variation-of-the-range-size-body-size-slope" class="section level2">
<h2 class="hasAnchor">
<a href="#case-study-2-geographical-variation-of-the-range-size-body-size-slope" class="anchor"></a>Case study 2: Geographical variation of the range size<code>~</code> body size slope</h2>
<div id="the-range-size-body-size-slope-map" class="section level3">
<h3 class="hasAnchor">
<a href="#the-range-size-body-size-slope-map" class="anchor"></a>1. The range size<code>~</code> body size slope map</h3>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="va">lm_slope</span> <span class="op">=</span> <span class="kw">function</span> <span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span>
  <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/scale.html">scale</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="va">breeding_range_area</span><span class="op">)</span><span class="op">)</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/scale.html">scale</a></span><span class="op">(</span><span class="va">male_tarsus</span><span class="op">)</span>, <span class="va">x</span><span class="op">)</span>  <span class="op">%&gt;%</span> 
  <span class="va">summary</span> <span class="op">%&gt;%</span> <span class="va">coefficients</span> <span class="op">%&gt;%</span> <span class="va">data.frame</span> <span class="op">%&gt;%</span> <span class="va">.</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span>, <span class="op">]</span> 
  <span class="op">}</span>


<span class="fu"><a href="../reference/rmap_save_map.html">rmap_save_map</a></span><span class="op">(</span><span class="va">con</span>, fun <span class="op">=</span> <span class="va">lm_slope</span>, src<span class="op">=</span><span class="st">'wrens'</span>, dst<span class="op">=</span><span class="st">'slope_area_body_mass'</span><span class="op">)</span></code></pre></div>
</div>
<div id="maps-load-and-display-1" class="section level3">
<h3 class="hasAnchor">
<a href="#maps-load-and-display-1" class="anchor"></a>2. Maps: load and display</h3>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">m</span> <span class="op">=</span> <span class="fu"><a href="../reference/rmap_to_sf.html">rmap_to_sf</a></span><span class="op">(</span><span class="va">con</span>, <span class="st">'slope_area_body_mass'</span><span class="op">)</span>

<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">m</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html">geom_sf</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="va">Estimate</span><span class="op">)</span>,  size<span class="op">=</span> <span class="fl">0.05</span>, show.legend <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_gradient.html">scale_fill_gradientn</a></span><span class="op">(</span>colours <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/viridisLite/man/viridis.html">viridis</a></span><span class="op">(</span><span class="fl">10</span>, option <span class="op">=</span> <span class="st">'E'</span><span class="op">)</span> <span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ggtitle</a></span><span class="op">(</span><span class="st">"Range size ~ Body size slope"</span><span class="op">)</span></code></pre></div>
<p><img src="Case_studies_Valcu_et_al_2012_files/figure-html/unnamed-chunk-10-1.png" width="700"></p>
</div>
</div>
<div id="case-study-3-the-influence-of-cell-size-on-body-size-species-richness-slope" class="section level2">
<h2 class="hasAnchor">
<a href="#case-study-3-the-influence-of-cell-size-on-body-size-species-richness-slope" class="anchor"></a>Case study 3: The influence of cell size on body size <code>~</code> species richness slope</h2>
<div id="assemblage-level-median-body-size-species-richness-slope-for-varying-cell-sizes-" class="section level3">
<h3 class="hasAnchor">
<a href="#assemblage-level-median-body-size-species-richness-slope-for-varying-cell-sizes-" class="anchor"></a>1. assemblage level median body size <code>~</code> species richness slope for varying cell sizes.</h3>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="va">cellSizes</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span>from <span class="op">=</span> <span class="fl">700</span>, to <span class="op">=</span> <span class="fl">1500</span>, length.out <span class="op">=</span> <span class="fl">5</span><span class="op">)</span>

<span class="va">FUN</span> <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">g</span><span class="op">)</span> <span class="op">{</span>
  <span class="fu"><a href="https://rdrr.io/r/base/options.html">options</a></span><span class="op">(</span>rmap.verbose <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>
  
  <span class="va">con</span> <span class="op">=</span> <span class="fu"><a href="../reference/rmap_connect.html">rmap_connect</a></span><span class="op">(</span><span class="op">)</span>
  <span class="fu"><a href="../reference/rmap_add_ranges.html">rmap_add_ranges</a></span><span class="op">(</span><span class="va">con</span>, x <span class="op">=</span> <span class="va">wrens</span>, ID <span class="op">=</span> <span class="st">'sci_name'</span><span class="op">)</span>
  <span class="fu"><a href="../reference/rmap_prepare.html">rmap_prepare</a></span><span class="op">(</span><span class="va">con</span>, <span class="st">'hex'</span>, cellsize<span class="op">=</span><span class="va">g</span><span class="op">)</span>
  <span class="fu"><a href="../reference/rmap_add_bio.html">rmap_add_bio</a></span><span class="op">(</span><span class="va">con</span>, <span class="va">wrens</span>, <span class="st">'sci_name'</span><span class="op">)</span>
  <span class="fu"><a href="../reference/rmap_save_map.html">rmap_save_map</a></span><span class="op">(</span><span class="va">con</span><span class="op">)</span>
  <span class="fu"><a href="../reference/rmap_save_map.html">rmap_save_map</a></span><span class="op">(</span><span class="va">con</span>, fun <span class="op">=</span> <span class="st">'median'</span>, src<span class="op">=</span><span class="st">'wrens'</span>, v <span class="op">=</span> <span class="st">'male_tarsus'</span>, dst<span class="op">=</span><span class="st">'median_male_tarsus'</span><span class="op">)</span>
  <span class="va">m</span> <span class="op">=</span> <span class="fu"><a href="../reference/rmap_to_sf.html">rmap_to_sf</a></span><span class="op">(</span><span class="va">con</span><span class="op">)</span>

  <span class="co"># lm at assemblage level</span>
  <span class="va">o</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/scale.html">scale</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="va">median_male_tarsus</span><span class="op">)</span><span class="op">)</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="va">species_richness</span><span class="op">)</span>, <span class="va">m</span><span class="op">)</span>  <span class="op">%&gt;%</span> 
        <span class="va">summary</span> <span class="op">%&gt;%</span> <span class="va">coefficients</span> <span class="op">%&gt;%</span> <span class="va">data.frame</span> <span class="op">%&gt;%</span> <span class="va">.</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span>, <span class="op">]</span>

  <span class="va">o</span><span class="op">$</span><span class="va">cell_size</span> <span class="op">=</span> <span class="va">g</span>

  <span class="fu"><a href="https://rdrr.io/r/base/options.html">options</a></span><span class="op">(</span>rmap.verbose <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>

  <span class="va">o</span>

  <span class="op">}</span>


<span class="va">o</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span><span class="op">(</span><span class="va">cellSizes</span>, <span class="va">FUN</span><span class="op">)</span>   <span class="op">%&gt;%</span> <span class="va">rbindlist</span></code></pre></div>
</div>
<div id="plot-regression-parameters-for-different-cell-sizes" class="section level3">
<h3 class="hasAnchor">
<a href="#plot-regression-parameters-for-different-cell-sizes" class="anchor"></a>2. Plot regression parameters for different cell sizes</h3>
<p>Most of the variation here is due to spatial autocorrelation, a proper analysis requires a spatial model.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">o</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">cell_size</span>, y <span class="op">=</span> <span class="va">Estimate</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<p><img src="Case_studies_Valcu_et_al_2012_files/figure-html/unnamed-chunk-12-1.png" width="700"></p>
</div>
</div>
<div id="case-study-4-the-influence-of-range-size-on-the-relationship-between-species-richness-and-body-size" class="section level2">
<h2 class="hasAnchor">
<a href="#case-study-4-the-influence-of-range-size-on-the-relationship-between-species-richness-and-body-size" class="anchor"></a>Case study 4: The influence of range size on the relationship between species richness and body size</h2>
<div id="set-parameters-1" class="section level3">
<h3 class="hasAnchor">
<a href="#set-parameters-1" class="anchor"></a>1. Set parameters</h3>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">quant</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0.05</span>, <span class="fl">1</span>, <span class="fl">0.1</span><span class="op">)</span> 
<span class="va">Q</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html">quantile</a></span><span class="op">(</span><span class="va">wrens</span><span class="op">$</span><span class="va">breeding_range_area</span>,  probs <span class="op">=</span> <span class="va">quant</span><span class="op">)</span>
<span class="va">range_classes</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>area <span class="op">=</span> <span class="va">Q</span>, quant <span class="op">=</span>  <span class="va">quant</span> <span class="op">)</span>
<span class="va">W</span> <span class="op">=</span> <span class="fl">4</span>   <span class="co"># size of the moving window</span>
<span class="va">maxn</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">range_classes</span><span class="op">)</span> <span class="op">-</span> <span class="va">W</span>

<span class="va">range_classes</span>
<span class="co">#&gt;                   area quant</span>
<span class="co">#&gt; 5%     1266.429 [km^2]  0.05</span>
<span class="co">#&gt; 15%    9478.286 [km^2]  0.15</span>
<span class="co">#&gt; 25%   37166.720 [km^2]  0.25</span>
<span class="co">#&gt; 35%   90305.220 [km^2]  0.35</span>
<span class="co">#&gt; 45%  154583.813 [km^2]  0.45</span>
<span class="co">#&gt; 55%  242971.371 [km^2]  0.55</span>
<span class="co">#&gt; 65%  405529.641 [km^2]  0.65</span>
<span class="co">#&gt; 75%  826032.987 [km^2]  0.75</span>
<span class="co">#&gt; 85% 3593309.929 [km^2]  0.85</span>
<span class="co">#&gt; 95% 5914782.138 [km^2]  0.95</span></code></pre></div>
</div>
<div id="make-subset-tables-for-multiple-range-size-intervals-" class="section level3">
<h3 class="hasAnchor">
<a href="#make-subset-tables-for-multiple-range-size-intervals-" class="anchor"></a>2. Make <code>subset</code> tables for multiple range size intervals.</h3>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="va">subsets</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">'area_subset_'</span>,<span class="fl">1</span><span class="op">:</span><span class="va">maxn</span> <span class="op">)</span>

<span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">maxn</span> <span class="op">)</span> <span class="op">{</span>
  <span class="fu"><a href="../reference/rmap_save_subset.html">rmap_save_subset</a></span><span class="op">(</span><span class="va">con</span>, <span class="va">subsets</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>, 
    wrens <span class="op">=</span> <span class="fu"><a href="https://glue.tidyverse.org/reference/glue.html">glue</a></span><span class="op">(</span><span class="st">"breeding_range_area BETWEEN 
            {range_classes[i,     'area']} AND 
            {range_classes[i+W, 'area']  }"</span><span class="op">)</span> <span class="op">)</span>
  <span class="op">}</span></code></pre></div>
</div>
<div id="make-median-body-mass-maps-for-all-subset-tables-" class="section level3">
<h3 class="hasAnchor">
<a href="#make-median-body-mass-maps-for-all-subset-tables-" class="anchor"></a>2. Make median body mass <code>maps</code> for all <code>subset</code> tables.</h3>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="va">maps</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">'body_size_'</span>, <span class="va">subsets</span><span class="op">)</span>

<span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">maxn</span> <span class="op">)</span> <span class="op">{</span>
  <span class="fu"><a href="../reference/rmap_save_map.html">rmap_save_map</a></span><span class="op">(</span><span class="va">con</span>, subset <span class="op">=</span> <span class="va">subsets</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>, dst <span class="op">=</span> <span class="va">maps</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>,  
                fun <span class="op">=</span> <span class="st">'median'</span>, src<span class="op">=</span><span class="st">'wrens'</span>, v <span class="op">=</span> <span class="st">'male_tarsus'</span><span class="op">)</span>
    <span class="op">}</span></code></pre></div>
</div>
<div id="get-maps-and-run-run-assemblage-body-size-species_richness-regression" class="section level3">
<h3 class="hasAnchor">
<a href="#get-maps-and-run-run-assemblage-body-size-species_richness-regression" class="anchor"></a>3. Get <code>maps</code> and run Run <code>assemblage body size ~ species_richness</code> regression</h3>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="va">m</span> <span class="op">=</span> <span class="fu"><a href="../reference/rmap_to_sf.html">rmap_to_sf</a></span><span class="op">(</span><span class="va">con</span>, pattern <span class="op">=</span> <span class="st">'richness|body'</span><span class="op">)</span>  <span class="op">%&gt;%</span> <span class="va">setDT</span>
<span class="va">m</span> <span class="op">=</span> <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/melt.data.table.html">melt</a></span><span class="op">(</span><span class="va">m</span>, measure.vars <span class="op">=</span> <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/patterns.html">patterns</a></span><span class="op">(</span><span class="st">"median"</span><span class="op">)</span> <span class="op">)</span>

<span class="va">x</span> <span class="op">=</span> <span class="va">m</span><span class="op">[</span>, <span class="op">{</span> 
      
      <span class="va">fm</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log10</a></span><span class="op">(</span><span class="va">value</span><span class="op">)</span> <span class="op">~</span>  <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="va">species_richness</span><span class="op">)</span> <span class="op">)</span>
      <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/data.table.html">data.table</a></span><span class="op">(</span> Estimate <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/coef.html">coefficients</a></span><span class="op">(</span><span class="va">fm</span><span class="op">)</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>, <span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/stats/confint.html">confint</a></span><span class="op">(</span><span class="va">fm</span><span class="op">)</span><span class="op">[</span><span class="fl">2</span>, <span class="op">]</span><span class="op">)</span> <span class="op">)</span>
      
      <span class="op">}</span> , by <span class="op">=</span> <span class="va">variable</span><span class="op">]</span>

<span class="va">x</span><span class="op">[</span>, <span class="va">Quantiles</span> <span class="op">:=</span>  <span class="va">quant</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="va">maxn</span><span class="op">]</span>  <span class="op">]</span></code></pre></div>
</div>
<div id="plot-regression-slope-for-different-quantile-based-range-size-intervals" class="section level3">
<h3 class="hasAnchor">
<a href="#plot-regression-slope-for-different-quantile-based-range-size-intervals" class="anchor"></a>4. Plot regression slope for different quantile-based range size intervals</h3>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">x</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Quantiles</span>, y <span class="op">=</span> <span class="va">Estimate</span><span class="op">)</span> <span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_linerange.html">geom_errorbar</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>ymin <span class="op">=</span> <span class="va">`2.5 %`</span>, ymax <span class="op">=</span> <span class="va">`97.5 %`</span><span class="op">)</span>, width<span class="op">=</span> <span class="fl">0</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<p><img src="Case_studies_Valcu_et_al_2012_files/figure-html/unnamed-chunk-17-1.png" width="700"></p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by <a href="https://github.com/mpio-be">Mihai Valcu</a>, James Dale.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.9000.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
